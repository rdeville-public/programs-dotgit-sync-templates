---
"Validate OpenTofu":
  image: ghcr.io/opentofu/opentofu:latest
  stage: lint
  before_script:
    - tofu init -backend=false
  script:
    - tofu validate
  rules:
    # Do Not run when called from upstream CI as its DGS template update
    - if: $CI_PIPELINE_SOURCE == "pipeline" && $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH
      when: never
      # Always run this job to ensure commit follow specific syntax as soon as
      # possible
    - when: always
